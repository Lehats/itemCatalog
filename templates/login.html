<html>
    <head>
		<link href='http://fonts.googleapis.com/css?family=Roboto:400,300,700' rel='stylesheet' type='text/css'>
		<link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">
        <link rel=stylesheet type=text/css href="{{ url_for('static', filename='styles.css') }}">
        <script src="//apis.google.com/js/platform.js?onload=start"> </script>
        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
	</head>
    <body>
        <div class="container">
            <div class="row top-menu">
                <div class="col-lg-1"></div>
                <div class="col-lg-5 header-left">
                    
                        <a href="{{url_for('getMainPage')}}">
                            <span class="glyphicon glyphicon-home" aria-hidden="true"></span>
                        </a>
                        <p>Item catalog</p>
                    
                    
                </div>
                <div class="col-lg-5 text-right">
                    <a href="{{url_for('getMainPage')}}">Click Here to Log in </a>
                </div>
                <div class="col-lg-1"></div>
            </div>
            <div class="row divider blue">
                <div class="col-lg-12"></div>
            </div>
                <div class="row content">
                    <div class="col-lg-1"></div>
                    <div class="col-lg-10 main-content">                    
                        <div class="categories">
                            <h3>Log in:</h3>
                            <form method="POST" action="/existingUser?state={{STATE}}">
                                <p>Username:</p>
                                    <input name="username" type="text" placeholder="username"><br>
                                        
                                <p>Password:</p>
                                    <input name="password" type="text" placeholder="Password"><br>
                                    <input type="submit" value="Submit">
                            </form>                                     
                        </div>    
                        <div class="recentItems">
                            <h3>Sign up:</h3>
                            <form method="POST" action="/newUser?state={{STATE}}">
                                <p>Username:</p>
                                    <input name="username" type="text" placeholder="username"><br>
                                    
                                <p>Password:</p>
                                    <input name="password" type="text" placeholder="Password"><br>
                                    <input type="submit" value="Submit">
                            </form>                                   
                        </div>
                        <!-- GOOGLE PLUS SIGN IN-->
                        
                        
                        <div id="signinButton">
                            <span class="g-signin" 
                            data-scope="openid email" 
                            data-clientid="268128492649-g3sr78k2kr4o08kr8h4i3kurvb655si6.apps.googleusercontent.com"
                            data-redirecturi="postmessage" 
                            data-accesstype="offline" 
                            data-cookiepolicy="single_host_origin" 
                            data-callback="signInCallback"
                            data-approvalprompt="force">
                            </span>
                        </div>
                        
                        <div id="result"></div>
                        
                        <script>
                            function signInCallback(authResult) {
                                if (authResult['code']) {
                                    // Hide the sign-in button now that the user is authorized
                                    $('#signinButton').attr('style', 'display: none');
                                    // Send the one-time-use code to the server, if the server responds, write a 'login successful' message to the web page and then redirect back to the main restaurants page
                                    $.ajax({
                                        type: 'POST',
                                        url: '/gconnect?state={{STATE}}',
                                        processData: false,
                                        data: authResult['code'],
                                        contentType: 'application/octet-stream; charset=utf-8',
                                        success: function (result) {
                                            // Handle or verify the server response if necessary.
                                            if (result) {
                                                $('#result').html('Login Successful!</br>' + result + '</br>Redirecting...')
                                                setTimeout(function () {
                                                    window.location.href = "/restaurant";
                                                }, 4000);

                                            } else if (authResult['error']) {
                                                console.log('There was an error: ' + authResult['error']);
                                            } else {
                                                $('#result').html('Failed to make a server-side call. Check your configuration and console.');
                                            }
                                        }

                                    });
                                }
                            }
                        </script>
                        
                        <!--END GOOGLE PLUS SIGN IN -->
                        </div>
                    <div class="col-lg-1"></div>
                </div>
            </div>

        </div>
        
    </body>
</html>